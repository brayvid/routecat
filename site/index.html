<!--
Title: ACRoute
Version: 1.2
License: (c) 2020 Blake Rayvid. Non-commercial use only.
Author: Blake Rayvid (https//github.com/brayvid)  */
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>

        ACRoute

    </title>

    <!-- Bootstrap CSS 4.5.2 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <!-- Local stylesheet CSS -->
    <style>
        html {
            position: relative;
            min-height: 100%;
            margin: 0;
        }

        body {
            margin-bottom: 60px;
            /* Margin bottom by footer height */
        }

        .navbar {
            height: 100px;
        }

        .container {
            width: 100%;
            white-space: nowrap;
            padding-top: 20px;
        }

        #store {
            font-size: 0.9em;
        }

        .form-row {
            margin: 8px;
        }

        .buttonrow {
            padding: 12px;
            text-align: center;
        }

        .fieldbuttonrow {
            text-align: center;
        }

        #display {
            padding: 16px;
        }

        .btn {
            width: 40%;
        }

        .uploadButton {
            background-color: #2d096b;
            border-color: #2d096b;
            color: white;
        }

        #tablebody {
            padding: 10px;
        }

        #assign {
            background-color: #2d096b;
            border-color: #2d096b;
        }

        #displayTable {
            margin: 0;
        }

        .footer {
            position: absolute;
            bottom: 10px;
            width: 100%;
            height: 60px;
            line-height: 60px;
        }

        #footertext {
            text-align: center;
        }

        #googlelogo {
            display: inline;
            /* the default for span */
            height: 1.3em;
        }

        #map {
            margin: 0;
            padding: 0;
            height: 400px;
            width: auto;
            overflow: visible;
        }

        #fields {
            width: 100%;
        }

        .navbar-brand {
            text-align: center;
        }

        /* .upload {} */
    </style>

    <!-- JQuery JS 3.5.1 -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- Bootstrap JS 4.5.2 -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

    <!-- Main program JS -->
    <script src="src/acroute.js"></script>

    <!-- Google Maps JS API -->
    <script>
        const initGoogleAPI = async () => {
            try {
                const response = await fetch('/.netlify/functions/return-env');
                const resObj = await response.json();
                const JSLink = await `https://maps.googleapis.com/maps/api/js?key=${resObj.token}&callback=googleReady`;
                var JSElement = document.createElement('script');
                JSElement.src = JSLink;
                document.getElementsByTagName('head')[0].appendChild(JSElement);
            } catch (err) {
                console.log("Could not connect to Google Maps API.");
            }
        }
        initGoogleAPI();
    </script>
</head>

<body>
    <!-- Title bar -->
    <nav class="navbar-nav nav-fill w-100">
        <h6 class="navbar-brand">

            AlleyCatRoute

            <br>

            <form id="start" class=".w-auto">
            </form>

        </h6>
    </nav>

    <main role="main" class="container">
        <!-- Area for displaying table or status string -->
        <div id="display" class="collapse">
            <div id="tbl"></div>
            <div id="map"></div>
        </div>
        <!-- Buttons to add/remove field rows -->
        <div class="fieldbuttonrow">
            <button class="btn btn-default" onclick="removeField()">

                Remove row

            </button>
            <button class="btn btn-default" onclick="addField()">

                Add row

            </button>

        </div>
        <!-- Area for field grid -->
        <form id="fields">
        </form>


        <!-- Assign button -->
        <div class="buttonrow">
            <button id="assign" class="btn btn-primary" onclick="requestRoute()">

                Route

            </button>
        </div>
    </main>

    <footer class="footer">
        <div class="container" id="footertext">
            <span>
                <a href="https://cloud.google.com/"><img id="googlelogo" src="img/cloud.png"></img></a>
            </span>
        </div>
    </footer>

    <script>
        $(document).ready(function () {
            makeEndptFields();
            // Set initial number of input rows
            for (let r = 0; r < initialInputRows; r++) {
                addField();
            }
            // "Assign" button shows display
            $("#assign").click(function () {
                $(".collapse").collapse('show');
            });
        });
    </script>
</body>

</html>
